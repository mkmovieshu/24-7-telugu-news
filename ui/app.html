<!DOCTYPE html>
<html lang="te">
  <head>
    <meta charset="UTF-8" />
    <title>24/7 Telugu Short News</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/static/css/app.css" />
  </head>
  <body>
    <div class="app-container">
      <header class="app-header">
        <div class="app-logo"></div>
        <div class="app-title-block">
          <div class="app-title">24/7 Telugu Short News</div>
          <div class="app-subtitle">‡∞∏‡±ç‡∞µ‡±à‡∞™‡±ç ‡∞ö‡±á‡∞∏‡∞ø ‡∞í‡∞ï‡±ç‡∞ï‡±ä‡∞ï‡±ç‡∞ï ‡∞®‡±ç‡∞Ø‡±Ç‡∞∏‡±ç ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø</div>
        </div>
      </header>

      <main>
        <section id="news-card" class="news-card">
          <h1 id="news-title" class="news-title">‡∞ü‡±à‡∞ü‡∞ø‡∞≤‡±ç ‡∞≤‡±á‡∞¶‡±Å</h1>
          <p id="news-summary" class="news-summary">
            ‡∞®‡±ç‡∞Ø‡±Ç‡∞∏‡±ç ‡∞≤‡±ã‡∞°‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø...
          </p>
        </section>

        <div class="more-info-wrapper">
          <button id="more-info-btn" class="more-info-btn">
            ‡∞Æ‡∞∞‡∞ø‡∞Ç‡∞§ ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç
          </button>
        </div>

        <div class="reactions-row">
          <button id="like-btn" class="reaction-btn">
            <span>üëç</span>
            <span id="like-count" class="count">0</span>
          </button>
          <button id="dislike-btn" class="reaction-btn">
            <span>üëé</span>
            <span id="dislike-count" class="count">0</span>
          </button>
        </div>

        <p class="comments-helper">
          ‡∞ü‡±Ü‡∞ï‡±ç‡∞∏‡±ç‡∞ü‡±ç ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞Æ‡∞æ‡∞§‡±ç‡∞∞‡∞Æ‡±á ‚Äì ‡∞Æ‡±Ä ‡∞ï‡∞æ‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç ‡∞à ‡∞´‡±ã‡∞®‡±ç‚Äå‡∞≤‡±ã‡∞®‡±á ‡∞∏‡±á‡∞µ‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.
        </p>

        <input
          id="comment-text"
          type="text"
          class="comment-input"
          placeholder="‡∞Æ‡±Ä‡∞ï‡±Å ‡∞à ‡∞®‡±ç‡∞Ø‡±Ç‡∞∏‡±ç ‡∞é‡∞≤‡∞æ ‡∞Ö‡∞®‡∞ø‡∞™‡∞ø‡∞Ç‡∞ö‡∞ø‡∞Ç‡∞¶‡∞ø?"
        />

        <button id="save-comment-btn" class="comment-save-btn">
          ‡∞ï‡∞æ‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç ‡∞∏‡±á‡∞µ‡±ç ‡∞ö‡±á‡∞Ø‡±Å
        </button>

        <ul id="comments-list" class="comments-list"></ul>

        <footer class="app-footer">
          ‡∞ú‡±à‡∞≤‡±ç ‡∞®‡±ç‡∞Ø‡±Ç‡∞∏‡±ç ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø üëâ ‡∞§‡∞æ‡∞ú‡∞æ ‡∞®‡±ç‡∞Ø‡±Ç‡∞∏‡±ç<br />
          ‡∞™‡∞æ‡∞§ ‡∞®‡±ç‡∞Ø‡±Ç‡∞∏‡±ç ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø üëâ ‡∞™‡±ç‡∞∞‡±Ä‡∞µ‡∞ø‡∞Ø‡∞∏‡±ç ‡∞®‡±ç‡∞Ø‡±Ç‡∞∏‡±ç
        </footer>
      </main>
    </div>

    <!-- INLINE FALLBACK: ‡∞ö‡±Ç‡∞™‡∞ø‡∞Ç‡∞ö‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞í‡∞ï‡∞ü‡∞ø ‡∞Æ‡∞æ‡∞§‡±ç‡∞∞‡∞Æ‡±á (first item) ‚Äî modules ‡∞®‡∞°‡∞ö‡∞ø‡∞®‡∞™‡±Å‡∞°‡±á ‡∞á‡∞¶‡∞ø harmless -->
    <script>
      (async function () {
        try {
          // small timeout to allow module load to start first ‚Äî if module runs it'll override
          await new Promise((r) => setTimeout(r, 250));
          // if main module already set content, we shouldn't overwrite ‚Äî check title text
          const titleEl = document.getElementById("news-title");
          if (!titleEl || (titleEl && titleEl.dataset && titleEl.dataset.rendered === "1")) {
            // module already rendered ‚Äî don't run fallback
            return;
          }

          const res = await fetch("/news");
          if (!res.ok) throw new Error("Fetch /news failed: " + res.status);
          const data = await res.json();
          const items = data.items || [];
          if (!items.length) return;

          const it = items[0];
          if (titleEl) {
            titleEl.textContent = it.title || "‡∞ü‡±à‡∞ü‡∞ø‡∞≤‡±ç ‡∞≤‡±á‡∞¶‡±Å";
            // mark as rendered by fallback (so module won't overwrite check)
            titleEl.dataset.rendered = "fallback";
          }
          const summaryEl = document.getElementById("news-summary");
          if (summaryEl) summaryEl.textContent = it.summary || it.raw_summary || "";

          const moreBtn = document.getElementById("more-info-btn");
          if (moreBtn) {
            moreBtn.onclick = function () {
              if (it.link) window.open(it.link, "_blank");
            };
          }

          const likeCount = document.getElementById("like-count");
          const dislikeCount = document.getElementById("dislike-count");
          if (likeCount) likeCount.textContent = it.likes ?? 0;
          if (dislikeCount) dislikeCount.textContent = it.dislikes ?? 0;

          console.log("Fallback: rendered first news item id=", it.id);
        } catch (err) {
          // don't break page if fetch blocked
          console.warn("Fallback render failed:", err);
        }
      })();
    </script>

    <!-- main module with cache-bust (bump ?v on deploy) -->
    <script type="module" src="/static/js/main.js?v=20241204T1500"></script>
  </body>
</html>
